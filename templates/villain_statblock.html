{% extends "templates/base.html" %}
{% load smart_if %}
{% load humanize %}
{% block title %}
	{% if villain_level != '0' %}{{ villain_level|ordinal }} Level {% endif %}
	{{ villain_role.name }}
{% endblock %}
{% block head %}

<script type="text/javascript" src="{{ MEDIA_URL }}scripts/create_villain.js"></script>

<script type="text/javascript">

	/*
	function displayVillain(selected, role_name, role_slug){
		new_villain = create_villain(selected, role_name, role_slug);
		new_statblock = new DPoNIStatblock(new_villain, role_name, "#StatBlock");
		new_statblock.display();
		$("title").html(new_statblock.make_ordinal(new_statblock.Level) + ' Level ' + role_name);
	};
	*/
	
	$(document).ready(function(){
		var selected = {{ villain_level }};
		var role_slug = '{{ villain_role.slug }}';
		var role_name = '{{ villain_role.name }}';
		
		//set the level select options
		document.VillainLevelSelector.Villain_Level.options.length = 0;
		for (i = 1; i <= 20; i++){
			document.VillainLevelSelector.Villain_Level.options[i] = new Option(i, i);
		}
		
		// if a level has been indicated in the URL, set the selector
		// and display the villain
		if (selected != '0') {
			var current_level = document.VillainLevelSelector.Villain_Level[selected];
			current_level.selected = true;
			create_villain(selected, role_name, role_slug);
		}

		$("#level").change(function(){
			name = "";
			var new_select = document.VillainLevelSelector.Villain_Level.options.selectedIndex;
			create_villain(new_select, role_name, role_slug);
			
			location.pathname = '{{ villain_url }}' + new_select;

		});
		/*
		
		if (selected != '0') {
			var current_level = document.VillainLevelSelector.Villain_Level[selected];
			
			current_level.selected = true;
			
			selected_level = create_villain(selected, role_name, role_slug);
			
			new_villain = new DPoNIStatblock(selected_level, role_name, "#StatBlock");
			new_villain.display();
			$("title").html(new_villain.make_ordinal(new_villain.Level) + ' Level ' + role_name);
		}
		
		$("#level").change(function(){
			name = "";
			var new_select = document.VillainLevelSelector.Villain_Level.options.selectedIndex;
			
			selected_level = create_villain(new_select, role_name, role_slug);
			
			new_villain = new DPoNIStatblock(selected_level, role_name, "#StatBlock");
			new_villain.display();
			$("title").html(new_villain.make_ordinal(new_villain.Level) + ' Level ' + role_name);
			
			location.pathname = '{{ villain_url }}' + new_select;
					
		});
		
		*/
	});
	
</script>

{% endblock%}
{% block content %}

	<div class="noprint">
	<h4 style="float:left; padding-right: 1em">Select {{ villain_role }} Level:</h4>
	
	<form name="VillainLevelSelector" style="padding-top: 1.8em;">
		<select name="Villain_Level" id="level"></select>
	</form>
	</div>
	
	<div id="StatBlock" style="display:none; clear:left" ></div>
	
	<div style="clear:left" class="noprint">
		<h3>About {{ villain_role.name }}{% if villain_role.name != "Artillery" %}s{% endif %}</h3>
		{{ villain_role.description|safe }}
	</div>
	
	<div id="villain_selection" style="clear:left" class="noprint">
		<h2>Select a{% if villain_role.name %}nother{% endif %} Villain type:</h2>
		<p><a href="{% url villain_role 'Artillery' %}">Artillery</a> ::
		 <a href="{% url villain_role 'Brute' %}">Brute</a> ::
		 <a href="{% url villain_role 'Controller' %}">Controller</a> ::
		 <a href="{% url villain_role 'Lurker' %}">Lurker</a> ::
		 <a href="{% url villain_role 'Skirmisher' %}">Skirmisher</a> ::
		 <a href="{% url villain_role 'WarLeader' %}">War Leader</a></p>
	</div>
	{% if latest_updates %}
	<div id="updates" class="noprint">
		<h2>Some Recent Updates</h2>
		
		
			<ul id="island-list">
				{% for island in latest_updates %}
					<li class="{% cycle 'tbeven' 'tbodd' %}"><a href="{{ island.get_absolute_url }}">{{ island.name }}</a>: {{ island.latest_changeset.comment }} ({{ island.latest_changeset.modified|timesince }} ago)</li>
				{% endfor %}
			</ul>
	</div>
	{% endif %}
	
{% endblock %}