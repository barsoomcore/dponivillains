{% extends "templates/base.html" %}
{% load smart_if %}
{% load humanize %}
{% block title %}
	{% if villain_level != '0' %}{{ villain_level|ordinal }} Level {% endif %}
	{{ villain_role.name }}
{% endblock %}
{% block head %}

<script type="text/javascript" src="{{ MEDIA_URL }}scripts/villain_statblock.js"></script>

<script type="text/javascript">
	
	$(document).ready(function(){
		var selected = {{ villain_level }};
		var skills = {{ villain_skills|safe }};
		var villain_data = {{villain_data|safe }};
		var role_name = '{{ villain_role }}';
		
		//set the level select options
		document.Villain.Villain_Level.options.length = 0;
		for (i = 1; i <= villain_data.length; i++){
			document.Villain.Villain_Level.options[i] = new Option(i, i);
		}
		
		// if a level has been indicated in the URL, set the selector
		// and display the villain
		if (selected != '0') {
			var current_level = document.Villain.Villain_Level[selected];
			current_level.selected = true;
			var villain_obj = create_villain(selected, villain_data, skills, role_name);			
			villain_obj.display();
			$(".villain_link").show();
		}
		
		$("#level").change(function(){
			name = "";
			var new_select = document.Villain.Villain_Level.options.selectedIndex;
			var villain_obj = create_villain(new_select, villain_data, skills, role_name);				
			villain_obj.display();
			$(".villain_link").attr('href', '{{ villain_url }}' + new_select);
			$(".villain_link").show();
			$("title").html(villain_obj.Level + ' Level ' + role_name);
					
		});
		
	});
	
</script>

{% endblock%}
{% block content %}

	<div class="noprint">
	<h4 style="float:left; padding-right: 1em">Select {{ villain_role.name }} Level:</h4>
	
	<form name="Villain" style="padding-top: 1.8em;">
		<select name="Villain_Level" id="level">
		</select>
	</form>
	
	</div>
	
	<div class="StatBlock" style="display:none; clear:left" ></div>
	
	<p><a class="villain_link noprint" style="display:none" href="{% url villain_role_and_level villain=villain_role.slug level=villain_level %}">Permanent link to this villain</a></p>
	
	{% if villain_role.name %}
		<div style="clear:left" class="noprint">
			<h3>About {{ villain_role.name }}{% if villain_role.name != "Artillery" %}s{% endif %}</h3>
			{{ villain_role.description|safe }}
		</div>
	{% endif %}
	
	<div id="villain_selection" style="clear:left" class="noprint">
		<h2>Select a{% if villain_role.name %}nother{% endif %} Villain type:</h2>
		<p><a href="{% url villain_role 'Artillery' %}">Artillery</a> ::
		 <a href="{% url villain_role 'Brute' %}">Brute</a> ::
		 <a href="{% url villain_role 'Controller' %}">Controller</a> ::
		 <a href="{% url villain_role 'Lurker' %}">Lurker</a> ::
		 <a href="{% url villain_role 'Skirmisher' %}">Skirmisher</a> ::
		 <a href="{% url villain_role 'WarLeader' %}">War Leader</a></p>
	{% if latest_updates %}
	<div id="updates" class="noprint">
		<h2>Some Recent Updates</h2>
		
		
			<ul id="island-list">
				{% for island in latest_updates %}
					<li class="{% cycle 'tbeven' 'tbodd' %}"><a href="{{ island.get_absolute_url }}">{{ island.name }}</a>: {{ island.latest_changeset.comment }} ({{ island.latest_changeset.modified|timesince }} ago)</li>
				{% endfor %}
			</ul>
	</div>
	{% endif %}
	
{% endblock %}